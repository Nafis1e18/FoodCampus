<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{base::layout(~{::section})}">
<head>
	<meta charset="ISO-8859-1">
	<title>My Profile - FoodCampus</title>
</head>
<body>
<section>
	<!-- Header Background -->
	<div class="container-fluid"
		 style="background: linear-gradient(135deg, #606c88 0%, #3f4c6b 100%);
                   padding: 80px 20px 100px 20px;
                   margin-top: 56px;">
		<div class="text-center text-white">
			<h1 class="display-4 fw-bold mb-2" style="animation: fadeInDown 1s ease-in-out;">
				<i class="fa-solid fa-user-circle"></i> My Profile
			</h1>
			<p class="lead" style="opacity: 0.9; animation: fadeInUp 1s ease-in-out;">
				Manage your personal information and account settings
			</p>
		</div>
	</div>

	<!-- Main Content -->
	<div class="container" style="margin-top: -50px; margin-bottom: 50px;">
		<div class="row justify-content-center">
			<div class="col-lg-10">

				<!-- Success/Error Messages -->
				<div style="animation: fadeInDown 0.5s ease-in-out;">
					<th:block th:if="${session.succMsg}">
						<div class="alert alert-success alert-dismissible fade show shadow-sm"
							 role="alert"
							 style="border-radius: 15px; border-left: 5px solid #28a745;">
							<i class="fa-solid fa-check-circle"></i>
							<strong>Success!</strong> [[${session.succMsg}]]
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
						</div>
						<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
					</th:block>

					<th:block th:if="${session.errorMsg}">
						<div class="alert alert-danger alert-dismissible fade show shadow-sm"
							 role="alert"
							 style="border-radius: 15px; border-left: 5px solid #dc3545;">
							<i class="fa-solid fa-exclamation-circle"></i>
							<strong>Error!</strong> [[${session.errorMsg}]]
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
						</div>
						<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
					</th:block>
				</div>

				<!-- Profile Card -->
				<div class="card border-0 shadow-lg mb-4"
					 style="border-radius: 20px; animation: fadeInUp 1s ease-in-out;">

					<!-- Profile Header with Image -->
					<div class="card-body text-center pt-5 pb-3" style="background: white; border-radius: 20px 20px 0 0;">
						<div class="position-relative d-inline-block mb-3">
							<img alt="Profile Picture"
								 th:src="@{'../img/profile_img/'+${user.profileImage}}"
								 class="shadow-lg"
								 style="width: 150px;
                                     height: 150px;
                                     border-radius: 50%;
                                     border: 5px solid white;
                                     object-fit: cover;
                                     box-shadow: 0 10px 30px rgba(0,0,0,0.2) !important;
                                     animation: scaleIn 1s ease-in-out;">
							<!-- Status Badge -->
							<span class="position-absolute bottom-0 end-0 badge rounded-pill"
								  th:classappend="${user.isEnable} ? 'bg-success' : 'bg-danger'"
								  style="padding: 8px 12px; font-size: 0.8rem;">
                            <i class="fa-solid" th:classappend="${user.isEnable} ? 'fa-check' : 'fa-times'"></i>
                            [[${user.isEnable ? 'Active' : 'Inactive'}]]
                         </span>
						</div>

						<h3 class="fw-bold mb-1" style="color: #333;">[[${user.name}]]</h3>
						<p class="text-muted mb-0">
							<i class="fa-solid fa-envelope"></i> [[${user.email}]]
						</p>
						<span class="badge mt-2"
							  style="background: linear-gradient(135deg, #606c88 0%, #3f4c6b 100%);
                                   padding: 8px 15px;
                                   font-size: 0.9rem;">
                         <i class="fa-solid fa-shield-halved"></i> [[${user.role}]]
                      </span>
					</div>

					<!-- Profile Information Form -->
					<div class="card-body p-4" style="background: #f8f9fa; border-radius: 0 0 20px 20px;">
						<h5 class="fw-bold mb-4" style="color: #333;">
							<i class="fa-solid fa-user-edit"></i> Personal Information
						</h5>

						<form action="/user/update-profile" method="post" enctype="multipart/form-data">
							<div class="row g-3">

								<!-- Full Name -->
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-user"></i> Full Name
									</label>
									<input type="text"
										   name="name"
										   class="form-control form-control-lg"
										   th:value="${user.name}"
										   required
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- Mobile Number -->
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-phone"></i> Mobile Number
									</label>
									<input type="text"
										   name="mobileNumber"
										   class="form-control form-control-lg"
										   th:value="${user.mobileNumber}"
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- Email (Read-only) -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-envelope"></i> Email Address
									</label>
									<input type="email"
										   class="form-control form-control-lg"
										   readonly
										   th:value="${user.email}"
										   style="border: 2px solid #e9ecef; border-radius: 10px; background: #e9ecef; cursor: not-allowed;">
								</div>

								<!-- Address -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-location-dot"></i> Address
									</label>
									<input type="text"
										   name="address"
										   class="form-control form-control-lg"
										   th:value="${user.address}"
										   placeholder="Enter your street address"
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- City -->
								<div class="col-md-4">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-city"></i> City
									</label>
									<input type="text"
										   name="city"
										   class="form-control form-control-lg"
										   th:value="${user.city}"
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- State -->
								<div class="col-md-4">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-map"></i> State
									</label>
									<input type="text"
										   name="state"
										   class="form-control form-control-lg"
										   th:value="${user.state}"
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- Pincode -->
								<div class="col-md-4">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-map-pin"></i> Pincode
									</label>
									<input type="text"
										   name="pincode"
										   class="form-control form-control-lg"
										   th:value="${user.pincode}"
										   style="border: 2px solid #e9ecef; border-radius: 10px; transition: all 0.3s ease;"
										   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
										   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
								</div>

								<!-- Profile Image Upload -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-image"></i> Update Profile Picture
									</label>
									<input type="file"
										   name="img"
										   class="form-control form-control-lg"
										   accept="image/*"
										   style="border: 2px solid #e9ecef; border-radius: 10px;">
									<small class="text-muted">
										<i class="fa-solid fa-info-circle"></i> Accepted formats: JPG, PNG, GIF (Max 5MB)
									</small>
								</div>

								<input type="hidden" th:value="${user.id}" name="id">

								<!-- Submit Button -->
								<div class="col-12 text-center mt-4">
									<button type="submit"
											class="btn btn-lg px-5 fw-bold"
											style="background: linear-gradient(135deg, #606c88 0%, #3f4c6b 100%);
                                              color: white;
                                              border: none;
                                              border-radius: 25px;
                                              padding: 12px 50px;
                                              box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
                                              transition: all 0.3s ease;"
											onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(102, 126, 234, 0.6)';"
											onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 15px rgba(102, 126, 234, 0.4)';">
										<i class="fa-solid fa-save"></i> Update Profile
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>

				<!-- Change Password Card -->
				<div class="card border-0 shadow-lg"
					 style="border-radius: 20px; animation: fadeInUp 1.2s ease-in-out;">
					<div class="card-header text-white text-center border-0"
						 style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                               padding: 20px;
                               border-radius: 20px 20px 0 0;">
						<h4 class="mb-0 fw-bold">
							<i class="fa-solid fa-key"></i> Change Password
						</h4>
						<p class="mb-0 mt-2" style="opacity: 0.9; font-size: 0.95rem;">
							Keep your account secure by updating your password regularly
						</p>
					</div>

					<div class="card-body p-5">
						<form action="/user/change-password" method="post">
							<div class="row g-4">

								<!-- Current Password -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-lock"></i> Current Password
									</label>
									<div class="input-group">
                                  <span class="input-group-text"
										style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                               color: white;
                                               border: none;
                                               border-radius: 10px 0 0 10px;">
                                     <i class="fa-solid fa-shield-halved"></i>
                                  </span>
										<input type="password"
											   name="currentPassword"
											   id="currentPassword"
											   class="form-control form-control-lg"
											   required
											   placeholder="Enter your current password"
											   style="border: 2px solid #e9ecef; border-left: none; border-radius: 0 10px 10px 0; transition: all 0.3s ease;"
											   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
											   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
									</div>
								</div>

								<!-- New Password -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-key"></i> New Password
									</label>
									<div class="input-group">
                                  <span class="input-group-text"
										style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                               color: white;
                                               border: none;
                                               border-radius: 10px 0 0 10px;">
                                     <i class="fa-solid fa-lock-open"></i>
                                  </span>
										<input type="password"
											   name="newPassword"
											   id="newPassword"
											   class="form-control form-control-lg"
											   required
											   placeholder="Enter your new password"
											   style="border: 2px solid #e9ecef; border-left: none; border-radius: 0 10px 10px 0; transition: all 0.3s ease;"
											   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
											   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
									</div>
									<small class="text-muted">
										<i class="fa-solid fa-info-circle"></i> Password must be at least 8 characters long
									</small>
								</div>

								<!-- Confirm Password -->
								<div class="col-md-12">
									<label class="form-label fw-bold" style="color: #333;">
										<i class="fa-solid fa-check-double"></i> Confirm New Password
									</label>
									<div class="input-group">
                                  <span class="input-group-text"
										style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                               color: white;
                                               border: none;
                                               border-radius: 10px 0 0 10px;">
                                     <i class="fa-solid fa-rotate-right"></i>
                                  </span>
										<input type="password"
											   name="confirmPassword"
											   id="confirmPassword"
											   class="form-control form-control-lg"
											   required
											   placeholder="Confirm your new password"
											   style="border: 2px solid #e9ecef; border-left: none; border-radius: 0 10px 10px 0; transition: all 0.3s ease;"
											   onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 0 0 0.2rem rgba(102, 126, 234, 0.25)';"
											   onblur="this.style.borderColor='#e9ecef'; this.style.boxShadow='none';">
									</div>
								</div>

								<!-- Submit Button -->
								<div class="col-12 text-center mt-4">
									<button type="submit"
											class="btn btn-lg px-5 fw-bold"
											style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                                              color: white;
                                              border: none;
                                              border-radius: 25px;
                                              padding: 12px 50px;
                                              box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
                                              transition: all 0.3s ease;"
											onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(245, 87, 108, 0.6)';"
											onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 15px rgba(245, 87, 108, 0.4)';">
										<i class="fa-solid fa-sync-alt"></i> Update Password
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>

			</div>
		</div>
	</div>

	<!-- Custom CSS Animations -->
	<style>
		@keyframes fadeInDown {
			from {
				opacity: 0;
				transform: translateY(-30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes scaleIn {
			from {
				opacity: 0;
				transform: scale(0.8);
			}
			to {
				opacity: 1;
				transform: scale(1);
			}
		}

		/* Input Focus Effects */
		.form-control:focus {
			border-color: #667eea !important;
			box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25) !important;
		}
	</style>

</section>
</body>
</html>
